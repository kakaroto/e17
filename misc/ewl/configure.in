dnl Process this file with autoconf to create configure.

AC_INIT(src/main.c)
AM_INIT_AUTOMAKE(ewl, 0.2)

AC_PROG_CC
AC_PROG_CPP
AM_PROG_CC_STDC
AC_C_CONST

AC_PROG_INSTALL
AC_PROG_MAKE_SET
AM_PROG_LIBTOOL

AM_SANITY_CHECK

AM_MAINTAINER_MODE
AM_WITH_DMALLOC

dnl# Where are we?
AC_MSG_CHECKING(for distribution root)
DIST_ROOT=`pwd`
AC_SUBST(DIST_ROOT)
AC_MSG_RESULT($DIST_ROOT)

AC_ARG_WITH(imlib2,
        [  --with-imlib2=DIR       use imlib2 in <DIR>],
        [CFLAGS="$CFLAGS -I$withval/include"
        LIBS="-L$withval/lib $LIBS"])

AC_CHECK_LIB(Imlib2, imlib_load_image, , [
echo "ERROR:  You need libImlib2 to build ewl.";
             AC_MSG_ERROR([Fatal:  libImlib2 not found.])], -lm)
LIBS="$LIBS -lm"

AC_CHECK_LIB(ugly,huge_nekkid_pics_of_pabs_mom, , [
echo "WARNING: You appear to be missing terrabyte pr0n pictures of"
echo "         Tom Gilbert's mother. While these are not required"
echo "         to compile ewl, they would at least distract you"
echo "         while it builds..."])

AC_SUBST(CC)
AC_SUBST(CFLAGS)
AC_SUBST(CPPFLAGS)
AC_SUBST(LDFLAGS)
AC_SUBST(X_LIBS)
AC_SUBST(LIBS)


AC_OUTPUT(Makefile \
src/Makefile \
src/themes/Makefile \
src/themes/defaultTheme/Makefile \
src/themes/defaultTheme/images/Makefile
)

echo ""
echo "Make sure you run src/create_user_preferences.sh before"
echo "running ewltest for the first time"
