#!/usr/bin/perl

print "=pod\n\n\n\n";

print "=head1 NAME\n\n\nEnlightenment - The Window Manager that dares to do what others don't\n\n\n\n";

print "=head1 WARNING\n\n\n";

print "This documentation is automatically generated for you from the\n";
print "online help documentation.  It is NOT to be considered a full\n";
print "substitute for this documentation.  It may be accessed by\n";
print "middle clicking on your desktop and selecting the \"Help\" item.\n";
print "If you are not currently running enlightenment, you may access\n";
print "this documentation by running the dox Help Browser\n";
print "To do this, run ENLIGHTENMENT_BIN/dox ENLIGHTENMENT_ROOT/E-docs\n";
print "(where BIN and ROOT are the locations of your e binaries and shared\n";
print "files, respectively)\n\n\n\n\n";

print "=head1 DESCRIPTION\n\n\n";

undef $/;
$_ = <>;
s/<br>/ /gi;
s/<p\b[^>]*>/\n/gi;
s/<page\b[^>]*>/\n/gi;
s/<img[^>]*>/\n/gi;
s/\b_(\w+)\(\w+\)(?:<br>\n)?/undermunge($1)/ge;
s/^ (?=\w)//gm;

s{<font face=rothwell/25 color=#ffffff>(.*?)<font face=aircut3/12 color=#ffffff>}{maketitle($1)}seg;

s{<font face=aircut3/12 color=#ccaacc>(.*?)<font.*?>}{make_lit($1)}ges;
s{<font face=aircut3/10 color=#112222>(.*?)<font.*?>}{make_lit($1)}ges;

s/\n{2,}\s*((?:[A-Z]\w+ *)+)\n{2,}/\n\n=head2 $1\n\n/g;
s/\s+\.\n/. /gm;
s/\(more on next page \.\.\.\)\n//g;
s/More on the next page.\n\n//g;
s/<font\b[^>]*>//g;
s/ +$//gm;
s/\n{3,}/\n\n/g;
s/Frequently Asked Questions: Page .\n//g;
s/\n\nGNOME Setup Part 2\n//g;
s/\nnext page\n//g;
s/\n<br align=75\%>//g;
s/\n_.*\(faq.*\)\n\n/\n/g;
s/\n_.*\(faq.*\)\n\n/\n/g;
s/\n_.*\(faq.*\)\n\n/\n/g;
s/\n_.*\(faq.*\)\n\n/\n/g;
s/Documentation Index/Welcome To Enlightenment/g;
print;

print "\n\n\n\n=head1 FOR MORE INFORMATION\n\n\n";
print "Please see our web site at http://www.enlightenment.org\n";

sub undermunge {
    local $_ = shift;
    s/_/ /g;
    return $_;
} 

sub maketitle {
    local $_ = shift;
    s/\n/ /g;
    s/^\s+//;
    s/\s+$//;
    s/^/\n\n/;
    return $_;
} 

sub make_lit {
    local $_ = shift;
    s/^/    /gm;
    return $_;
} 
