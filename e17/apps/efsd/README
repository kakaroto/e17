
                              E F S D

               The Enlightenment File System Daemon

         ================================================


This is some preliminary documentation for EFSD. What is EFSD? It is a
file system daemon that executes file system operations asynchronously,
sending replies back to the clients which indicate the success, failure
or status of a command. The code provides both the daemon itself and
a high-level api to launch the commands contained in a library, libefsd.
See demo/demo.c for an example of how to use libefsd. The code has
examples that illustrate how to use libefsd by itself and when select()
is used to wait for things on multiple file descriptors.

The basic way of associating EFSD commands and the events the daemon
sends back to the client is via command IDs, one of which is returned
with every command launched. The replies contain the ID, the status
of the operation (success/failure) and the entire command to make
life easier. The structs you'll want to look at are in efsd/efsd.h.
The design is not unlike that of X events.

EFSD uses FAM for listing directories and the usual monitoring of files
and directories. FAM events are passed on to the client, as EFSD file-
change events, which contain the filecode as defined in fam.h, the file
name itself and the command ID that clients obtained when they started
to monitor a file.

EFSD implements (de)multiplexing of FAM events to multiple connected
clients, i.e. it keeps state on which clients ordered which files to be
monitored, using reference counting on the files to be monitored etc.
When a file is changed that is monitored by multiple clients, all of
those clients should receive EFSD filechange events. Generally, multi-
ple clients should work fine, but this part has not really seen a large
amount of testing yet :) Listing directory entries via efsd_listdir()
is an exception -- events generated for those commands are sent only to
the requesting client.


Requirements:
=============

* FAM, the File Alteration Monitor, available at
  http://oss.sgi.com/projects/fam.


To run the demo:
================

* Run ./autogen.sh, and make.
* Run make install if you want.
* Launch the daemon, use -f to keep it from forking into the
  background.
* If you did make install and libefsd is properly installed, just run
  efsddemo (I suggest using a directory where you have write permission
  and that contains a bunch of files to see something.), if not, cd
  into ./demo and ./run_efsddemo.sh.


There's still stuff to be done, check out the TODO file for that.

                              Have fun,
                              -- Christian <kreibich@aciri.org>.
